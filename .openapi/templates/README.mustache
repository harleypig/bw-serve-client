# Bitwarden CLI Vault Management API

This module supports the [Bitwarden CLI Vault Management
API](https://bitwarden.com/help/vault-management-api/), available via
Bitwarden CLI's `bw serve` command.

If you're looking for Bitwarden's public api (for organizational tools and
stuff) that API is [here](https://bitwarden.com/help/api/).

Please note that this module won't be supporting email and master password
login to start with. It's not the most secure method, but pull requests are
welcome. Also, SSO support is low on the todo list, as the author doesn't use
it.

## Generated Code

This Python package is automatically generated by the [OpenAPI
Generator](https://openapi-generator.tech) project:

- API Version: {{appVersion}}
- Package Version: {{packageVersion}}
{{^hideGenerationTimestamp}}
- Build Date: {{generatedDate}}
{{/hideGenerationTimestamp}}
- Generator Version: {{generatorVersion}}
{{^hideBuildPackage}}
- Build Package: {{generatorClass}}
{{/hideBuildPackage}}

## Requirements

* Python {{{generatorLanguageVersion}}}

* [Bitwarden
    CLI](https://bitwarden.com/download/#downloads-command-line-interface)
  - Instructions can be found
    [here](https://bitwarden.com/help/cli/#download-and-install)

## `bw serve` Configuration

This module expects the user of this module to manage the configuration and
setup of the `bw serve` server. Documentation is
[here](https://bitwarden.com/help/cli/#serve).

### Authentication Steps

These authentication steps are required for the `bw` cli tool regardless of
how it's being used. I'm including the basic steps you'll need to use this
module here for completeness. Be sure to read the
[documentation](https://bitwarden.com/help/cli/).

* Check status
  - unauthenticated, need to run `bw login --apikey`
  - locked, need to run `bw unlock`
  - unlocked, nothing needs to be done

#### `bw login --apikey`

* [docs](https://bitwarden.com/help/cli/#using-an-api-key)

Environment variables (both required):
* BW_CLIENTID
* BW_CLIENTSECRET

#### `bw unlock`

[docs](https://bitwarden.com/help/cli/#unlock)

* --passwordenv <ENVIRONMENT_VARIABLE>
* --passwordfile /path/to/file
* prompt for password

Capture BW_SESSION and set it.

In bash, only bash scripts can be sourced, so we can't set the environment
variable outside of the script. Provide an option for the user to be to do
something like the following.
```
BW_SESSION="$(bw-serve-client unlock [--passwordenv|--passwordfile|prompt])"
```
So they aren't stomping all over themselves when using both the command line
and this module.

There is a --session option for each command, but I'm not supporting that.

## Installation

### pip install

If the python package is hosted on a repository, you can install directly using:
```sh
pip install git+https://{{gitHost}}/{{{gitUserId}}}/{{{gitRepoId}}}.git
```
(you may need to run `pip` with root permission: `sudo pip install
git+https://{{gitHost}}/{{{gitUserId}}}/{{{gitRepoId}}}.git`)

Then import the package:
```python
import {{{packageName}}}
```

### Setuptools

Install via [Setuptools](http://pypi.python.org/pypi/setuptools).
```sh
python setup.py install --user
```
(or `sudo python setup.py install` to install the package for all users)

Then import the package:
```python
import {{{packageName}}}
```

### Tests

Execute `pytest` to run the tests.

## Getting Started

Please follow the [installation procedure](#installation--usage) and then run the following:

```python
{{#apiInfo}}{{#apis}}{{#-last}}{{#hasHttpSignatureMethods}}import datetime{{/hasHttpSignatureMethods}}{{/-last}}{{/apis}}{{/apiInfo}}
import time
import {{{packageName}}}
from {{{packageName}}}.rest import ApiException
from pprint import pprint
{{#apiInfo}}{{#apis}}{{#-first}}{{#operations}}{{#operation}}{{#-first}}
{{> python_doc_auth_partial}}

# Enter a context with an instance of the API client
with {{{packageName}}}.ApiClient(configuration) as api_client:
    # Create an instance of the API class
    api_instance = {{{packageName}}}.{{{classname}}}(api_client)
    {{#allParams}}
    {{paramName}} = {{{example}}} # {{{dataType}}} | {{{description}}}{{^required}} (optional){{/required}}{{#defaultValue}} (default to {{{.}}}){{/defaultValue}}
    {{/allParams}}

    try:
        {{#summary}}
        # {{{.}}}
        {{/summary}}
        {{#returnType}}api_response = {{/returnType}}api_instance.{{{operationId}}}({{#allParams}}{{#required}}{{paramName}}{{/required}}{{^required}}{{paramName}}={{paramName}}{{/required}}{{^-last}}, {{/-last}}{{/allParams}})
        {{#returnType}}
        print("The response of {{classname}}->{{operationId}}:\n")
        pprint(api_response)
        {{/returnType}}
    except ApiException as e:
        print("Exception when calling {{classname}}->{{operationId}}: %s\n" % e)
{{/-first}}{{/operation}}{{/operations}}{{/-first}}{{/apis}}{{/apiInfo}}
```

## Documentation for API Endpoints

{{#apiInfo}}{{#apis}}* [{{classname}}]({{apiDocPath}}{{classname}}.md)
{{/apis}}{{/apiInfo}}

## Documentation For Models

{{#models}}{{#model}}* [{{{classname}}}]({{modelDocPath}}{{{classname}}}.md)
{{/model}}{{/models}}
